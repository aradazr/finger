# شمارش انگشت و تشخیص حالت چهره با MediaPipe

این پروژه با وب‌کم تعداد انگشت‌های بالا را می‌شمارد، ژست‌های ساده (OK، Peace، Like/Dislike) را تشخیص می‌دهد و با FaceMesh حالت چهره را بین Happy / Sad / Neutral حدس می‌زند. خروجی روی تصویر نمایش داده می‌شود و در صورت نصب TTS پیام‌ها را می‌خواند.

## پیش‌نیازها
- Python 3.8+
- وب‌کم
- پکیج‌ها: `opencv-python`, `mediapipe`, (اختیاری) `pyttsx3`

نصب:
```bash
pip install opencv-python mediapipe pyttsx3
```
اگر صدا نمی‌خواهید، `pyttsx3` لازم نیست.

## اجرای سریع
```bash
cd /Users/aradazr/Desktop/finger
python finger_counter.py
```
خروج: کلید `q`

## امکانات
- شمارش انگشت برای هر دست + نمایش مجموع.
- ژست‌ها: OK، Peace/V، Like (شست بالا)، Dislike (شست پایین).
- حدس Emotion (Happy / Sad / Neutral) و نمایش ایموجی ساده.
- هشدار نور کم.
- ثبت رویدادها در `EVENT_BUFFER` (قابل گسترش به API/وب‌سوکت).
- بازخورد صوتی (اگر `pyttsx3` نصب باشد).

## ساختار و نکات کد
- فایل اصلی: `finger_counter.py`
- MediaPipe Hands برای دست، FaceMesh برای چهره.
- تابع‌های کلیدی:
  - `count_fingers(...)`: شمارش انگشت‌ها.
  - `classify_gesture(...)`: تشخیص ژست‌های ساده.
  - `detect_emotion(...)`: حدس حالت چهره با هیوریستیک دهان/لب.
  - `speak(...)`: گفتار متن در صورت موجود بودن `pyttsx3`.
  - `log_event(...)`: ذخیره رویداد در بافر کوچک.
- آستانه‌ها (Emotion/نور/ژست) ساده هستند؛ در صورت نیاز قابل تنظیم‌اند.

## نکات اجرا و عیب‌یابی
- اگر وب‌کم باز نشد: از درست بودن `cv2.VideoCapture(0)` مطمئن شوید؛ در برخی سیستم‌ها ممکن است شماره دوربین متفاوت باشد (مثلاً 1).
- اگر صدا کار نکرد: مطمئن شوید `pyttsx3` نصب است؛ روی مک ممکن است مجوز دسترسی به اسپیکر بخواهد.
- نور محیط کم باشد، دقت دست/چهره پایین می‌آید؛ نور مناسب فراهم کنید.

## کارهای پیشنهادی برای تمرین
- اضافه کردن سوئیچ CLI برای خاموش/روشن کردن TTS یا Emotion.
- ارسال رویدادها از `EVENT_BUFFER` به یک سرور یا داشبورد وب با وب‌سوکت.
- بهبود هیوریستیک Emotion یا استفاده از یک مدل سبک چهره.
- افزودن ژست‌های بیشتر و تعریف اکشن برای هر ژست (مثلاً اسکرین‌شات یا پخش صدا).

